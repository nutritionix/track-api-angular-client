/**
 * @license Track Api Angular Client
 * (c) 2016 Nutritionix, LLC. http://nutritinix.com
 * License: MIT
 */
!function(e,t,r){"use strict";var n=t.module("nix.track-api-client",[]);n.provider("nixTrackApiClient",function(){var e,r="https://trackapi.nutritionix.com/v1",a=r,u={},i={};this.setApiEndpoint=function(e){a=e},e=this.setApiCredentials=function(e,t){u.appId=e,u.appKey=t},this.setHttpConfig=function(e){t.isObject(e)&&(i=e)},this.$get=["$http",function(o){var s,d=function(e,t){return t=n.deepMerge({method:"GET",url:a+e,headers:{"x-user-jwt":d.getUserJwt(),"X-APP-ID":u.appId,"X-APP-KEY":u.appKey},params:{}},i,t),o(t)};return d.getApiEndpoint=function(e){return e?r:a},d.getUserJwt=function(){return t.isFunction(s)?s():s},d.setUserJwt=function(e){s=e},d.setApiCredentials=e,d.calories_nutrient=208,d.macronutrients=[204,606,205,291,269,203],d.natural={},d.natural.nutrients=function(e){return d("/natural/nutrients",{method:"POST",data:t.isString(e)?{query:e}:e})},d.natural.tags=function(e){return d("/natural/tags",{method:"POST",data:{query:e}})},d.natural.add=function(e){return d("/natural/add",{method:"POST",data:{query:e}})},d.natural.update=function(e,t){return d("/natural/update",{method:"PUT",data:{query:e,foods:t}})},d.log={},d.log.get=function(e,r){return t.isObject(e)&&(r=e,e=""),t.isObject(r)||(r={}),r.userId&&(e=r.userId),d("/log"+(e?"/"+e:""),{method:"GET",params:r})},d.log["delete"]=function(e){return d("/log",{method:"DELETE",data:{foods:e}})},d.log.add=function(e){return d("/log",{method:"POST",data:{foods:e}})},d.log.copy=function(e){var r;return 2===e.source?e.upc?d.log.barcode(e.upc):(r=t.copy(e),delete r.id,delete r.created_at,delete r.consumed_at,d.log.add([r])):d.natural.add([e.serving_qty,e.serving_unit,e.food_name].join(" "))},d.log.barcode=function(e){return d("/log/barcode",{method:"POST",data:{upc:e}})},d.log.update=function(e){return d("/log",{method:"PUT",data:{foods:e}})},d.oauth={facebook:{},fitbit:{}},d.oauth.facebook.i=function(e,t){return d("/oauth/facebook/i",{method:"POST",data:{access_token:e,ref_code:t}})},d.oauth.fitbit.sign=function(){return d("/oauth/fitbit/sign",{method:"POST",data:{}})},d.oauth.fitbit.unlink=function(e){return d("/oauth/fitbit/unlink",{})},d.users=function(){return d("/users",{method:"GET"})},d.users.preferences=function(e){return d("/users/preferences",{method:"POST",data:{users:t.isArray(e)?e:[e]}})},d.me=function(){return d("/me",{method:"GET"})},d.me.preferences=function(e){return d("/me/preferences",{method:"PUT",data:e})},d.auth={signup:{},updatePassword:{}},d.auth.signup.step1=function(e){return d("/auth/signup/step1",{method:"POST",data:e})},d.auth.signup.step2=function(e){return d("/auth/signup/step2",{method:"POST",data:e})},d.auth.signin=function(e){return d("/auth/signin",{method:"POST",data:e})},d.auth.updatePassword.request=function(e){var t={};return e.indexOf("@")?t.email=e:t.mobile_number=e,d("/auth/updatePassword",{method:"GET",params:t})},d.auth.updatePassword.set=function(e){return d("/auth/updatePassword",{method:"POST",data:e})},d.permissions={},d.permissions.request=function(e){return d("/premissions/request",{method:"POST",data:{users:t.isArray(e)?e:[e]}})},d.reports={},d.reports.totals=function(e){return d("/reports/totals",{method:"GET",params:e})},d.recipes={},d.recipes["delete"]=function(e){return d("/recipes",{method:"DELETE",data:{id:e}})},d.recipes.get=function(e,t){var r={};return t&&(r.user=t),e&&(r.id=e),d("/recipes",{method:"GET",params:r})},d.recipes.add=function(e,t){return d("/recipes",{method:"POST",data:{query:t,recipe_name:e}})},d.recipes.update=function(e,r,n){var a={id:e};return t.isUndefined(r)||(a.name=r),t.isUndefined(n)||(a.query=n),d("/recipes",{method:"PUT",headers:{"x-user-jwt":d.getUserJwt()},data:a})},d}]}),n.factory("nixTrackCalculator",function(){return{exerciseLevels:[{title:"Little to no exercise",factor:1.2},{title:"Light exercise (1-3 days per week)",factor:1.375},{title:"Moderate exercise (3-5 days per week)",factor:1.55},{title:"Heavy exercise (6-7 days per week)",factor:1.725},{title:"Very heavy exercise (twice per day, extra heavy workouts)",factor:1.9}],calculateBmr:function(e,t,r,n){return"f"===(e||"").toString().toLowerCase()[0]?447.593+9.247*t+3.098*r-4.33*n:88.362+13.397*t+4.799*r-5.677*n},calculateRecommendedCalories:function(e,t,r,n,a){return a=parseInt(a),(!a||0>a||a>4)&&(a=0),Math.round(this.exerciseLevels[a].factor*this.calculateBmr(e,t,r,n))}}}),n.filter("nutrient",function(){return function(e,r,n){var a;if(r=parseInt(r),r&&t.isArray(e))for(a in e)if(e.hasOwnProperty(a)&&parseInt(e[a].attr_id)===r)return n?e[a][n]:e[a];return null}}),n.deepMerge=function a(e,r){var n,u;if(arguments.length>2)return a(e,a.apply(null,Array.prototype.slice.call(arguments,1)));n=t.copy(e);for(u in r)r.hasOwnProperty(u)&&(n.hasOwnProperty(u)&&t.isObject(n[u])&&t.isObject(r[u])?n[u]=a(n[u],r[u]):n[u]=t.copy(r[u]));return n}}(window,window.angular);